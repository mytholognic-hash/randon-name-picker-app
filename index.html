<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÅ Random Name Picker</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;800&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    
    <style>
        /*
        ===================================================================
        --- GENERAL STYLES & BACKGROUND ---
        ===================================================================
        */
        body {
            font-family: 'Poppins', sans-serif;
            /* UPDATED: Lighter, more vibrant background gradient */
            background: linear-gradient(135deg, #f0f2f5 0%, #e0f7fa 100%); 
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 5% 80px 5%; /* Using percentage padding for fluid margins on wide screens */
            margin: 0;
            min-height: 100vh;
            box-sizing: border-box;
            line-height: 1.6;
            position: relative;
        }
        .main-container {
            background-color: #ffffff;
            border-radius: 18px; /* Slightly rounder */
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15); /* Stronger shadow */
            max-width: 1200px;
            width: 100%;
            margin-bottom: 30px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        h1 {
            color: #00796b; /* Teal color for title */
            margin-bottom: 20px;
            font-size: 2.5em;
            font-weight: 700;
            padding: 25px 0 10px;
            text-align: center;
        }

        /* --- Name Input Section (Focused & Creative Background) --- */
        .name-input-section {
            /* UPDATED: Using user-specified local image file */
            background: url('gift_bg.jpg') center/cover no-repeat; 
            padding: 40px;
            color: white;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
            position: relative;
            z-index: 1;
        }
        .name-input-section::before {
            /* Overlay for better text readability */
            background: rgba(0, 0, 0, 0.3); 
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
        }
        .name-input-section label {
            color: white;
            font-size: 1.3em; 
            font-weight: 700;
            margin-bottom: 15px;
        }
        textarea {
            width: calc(100% - 24px);
            height: 200px;
            margin-bottom: 20px;
            padding: 12px;
            border: 2px solid #00acc1; /* Cyan border */
            border-radius: 10px;
            font-size: 1.1em;
            resize: vertical;
            font-family: 'Poppins', sans-serif;
            box-shadow: 0 0 15px rgba(0, 172, 193, 0.3), inset 0 1px 5px rgba(0,0,0,0.1);
            background-color: rgba(255, 255, 255, 0.95);
        }
        textarea:disabled {
            background-color: rgba(230, 230, 230, 0.9);
        }

        /*
        ===================================================================
        --- BUTTON STYLES (Color Palette: Green, Orange, Red) ---
        ===================================================================
        */
        .action-results-section {
            padding: 30px 50px;
            text-align: center;
        }
        button {
            padding: 14px 30px; /* Larger buttons */
            border: none;
            border-radius: 999px; /* Pill shape */
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            margin: 8px;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        button:hover:not(:disabled) {
            transform: translateY(-4px); /* Stronger hover effect */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        #loadNamesButton { 
            background-color: #4caf50; /* Load: Green */
            color: #ffffff;
        }
        #loadNamesButton:hover:not(:disabled) { 
            background-color: #43a047; 
        }
        #drawButton { 
            background-color: #ff9800; /* Draw: Orange/Amber */
            color: #ffffff;
        }
        #drawButton:hover:not(:disabled) { 
            background-color: #fb8c00; 
        }
        #resetButton { 
            background-color: #f44336; /* Reset: Red */
            color: #ffffff;
        }
        #resetButton:hover:not(:disabled) { 
            background-color: #e53935; 
        }

        /*
        ===================================================================
        --- RESULT & ANIMATION & COUNT BOX STYLES ---
        ===================================================================
        */
        #resultDisplay {
            margin-top: 30px;
            font-size: 2.4em;
            font-weight: 700;
            color: #1976d2; /* Deep blue for status */
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 10px;
        }
        .draw-animation {
            font-size: 3em;
            color: #ffeb3b; /* Bright yellow/gold */
            animation: pulse 1s infinite alternate, bounce 0.5s infinite ease-in-out;
            text-shadow: 0 0 20px rgba(255, 235, 59, 0.9);
        }
        .winner-name {
            font-size: 4.5em; /* EVEN bigger name! */
            color: #c2185b; /* Deep pink/Red for celebration */
            font-weight: 800;
            text-shadow: 4px 4px 15px rgba(0,0,0,0.3), 0 0 30px rgba(194, 24, 91, 0.8);
            animation: popIn 0.5s ease-out;
            word-break: break-word; 
            line-height: 1;
            padding-top: 10px;
        }
        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }
        @keyframes pulse {
            from { opacity: 0.7; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1.05); }
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* COUNT BOXES */
        #nameCountDashboard {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin: 15px 0 25px;
        }
        .count-box {
            flex: 1; 
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        .count-box:hover {
            transform: translateY(-3px);
        }
        .total-box {
            background-color: #e3f2fd; /* Very light blue */
            border: 1px solid #90caf9;
        }
        .remaining-box {
            background-color: #fff9c4; /* Light yellow */
            border: 1px solid #ffeb3b;
        }
        .count-box span {
            display: block;
            font-size: 0.9em;
            color: #555;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .count-box strong {
            display: block;
            font-size: 2.2em; 
            font-weight: 800;
        }
        .total-box strong {
             color: #1976d2; 
        }
        .remaining-box strong {
             color: #f57f17; 
        }

        /*
        ===================================================================
        --- REMAINING LIST & FOOTER & RESPONSIVENESS ---
        ===================================================================
        */
        #remainingNamesContainer {
            margin-top: 35px;
            text-align: left;
            border-top: 1px solid #eee;
            padding-top: 25px;
            width: 100%;
        }
        #remainingNamesContainer h4 {
            color: #555;
            margin-bottom: 18px;
            font-size: 1.4em;
            font-weight: 600;
        }
        #remainingNamesList {
            list-style-type: decimal;
            padding-left: 25px;
            max-height: 280px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            background-color: #f9f9f9;
            box-shadow: inset 0 1px 5px rgba(0,0,0,0.02);
        }
        #remainingNamesList li {
            padding: 8px 0;
            border-bottom: 1px dotted #e8e8e8;
            font-size: 1.05em;
            color: #444;
        }
        #remainingNamesList li:last-child {
            border-bottom: none;
        }
        .app-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #37474f; 
            color: #bdc3c7; 
            text-align: center;
            padding: 5px 0;
            font-size: 0.75em;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
            z-index: 1000; 
        }
        .app-footer strong {
            font-weight: 600;
            color: #ecf0f1;
        }
        .sparkle {
            position: absolute;
            background-color: #ffeb3b;
            border-radius: 50%;
            animation: fadeOutSparkle 1s forwards;
            opacity: 0;
            transform: scale(0);
            pointer-events: none;
            z-index: 100;
        }
        @keyframes fadeOutSparkle {
            0% { opacity: 1; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(1.5); }
        }
        
        /* --- Responsive Fix: Media Query for smaller screens (<= 700px) --- */
        @media (max-width: 700px) {
            body {
                padding: 10px 10px 80px 10px;
            }
            .main-container {
                padding: 0;
            }
            .winner-name {
                font-size: 3em; 
            }
            .action-results-section {
                padding: 20px; 
            }
            #nameCountDashboard {
                flex-direction: column; 
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h1>üéÅ Random Name Picker</h1>
        
        <div class="name-input-section">
            <label for="nameInput">Enter names (one name per line):</label>
            <textarea id="nameInput" placeholder="John Doe
Jane Smith
Michael Johnson
Emily White
David Brown"></textarea>
            <button id="loadNamesButton">Load Names</button>
        </div>

        <div class="action-results-section">
            <div class="action-buttons">
                <button id="drawButton" disabled>Pick a Winner!</button>
                <button id="resetButton" disabled>Reset</button>
            </div>

            <h2 id="resultDisplay">...Load names to start...</h2>

            <div id="remainingNamesContainer">
                <h4>Remaining Names:</h4>
                
                <div id="nameCountDashboard">
                    <div class="count-box total-box">
                        <span>Total Names Loaded:</span>
                        <strong id="totalNameCount">0</strong>
                    </div>
                    <div class="count-box remaining-box">
                        <span>Names Remaining:</span>
                        <strong id="remainingCount">0</strong>
                    </div>
                </div>
                
                <ol id="remainingNamesList">
                    <li>No names loaded</li>
                </ol>
            </div>
        </div>
    </div>

    <footer class="app-footer">
        Created by <strong>Nicky</strong>
    </footer>
    <script>
        // BEGIN JAVASCRIPT CODE

        // NEW: Define Audio Objects Globally but initialize later
        let pickingSound;
        let winSound;

        let employeeNames = []; 
        let initialNames = [];  

        // References to HTML elements
        const nameInput = document.getElementById("nameInput");
        const loadNamesButton = document.getElementById("loadNamesButton");
        const drawButton = document.getElementById("drawButton");
        const resetButton = document.getElementById("resetButton");
        const resultDisplay = document.getElementById("resultDisplay");
        const remainingNamesList = document.getElementById("remainingNamesList");
        const mainContainer = document.querySelector(".main-container"); 
        
        // References for name counts
        const totalNameCountDisplay = document.getElementById("totalNameCount");
        const remainingCountDisplay = document.getElementById("remainingCount");

        // NEW FUNCTION: Initialize audio after first user click (Load Names button)
        function initializeAudio() {
            if (!pickingSound) { 
                // *** ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå .wav ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á ***
                pickingSound = new Audio('picking_sound.wav'); 
                pickingSound.loop = true; 
                pickingSound.volume = 0.5; 

                winSound = new Audio('win_jingle.wav'); 
                winSound.volume = 0.7; 
            }
        }

        // --- Core Functions ---

        // 1. Load Names from Textarea (MODIFIED to call initializeAudio)
        function loadNames() {
            const namesText = nameInput.value.trim();
            if (namesText === "") {
                alert("Please enter names before loading.");
                return;
            }

            employeeNames = namesText.split('\n')
                                     .map(name => name.trim())
                                     .filter(name => name !== '');

            if (employeeNames.length === 0) {
                alert("No valid names found. Please ensure names are separated by new lines.");
                return;
            }

            initialNames = [...employeeNames]; 
            
            // Call audio initializer function
            initializeAudio(); 
            
            // Set Total Count 
            totalNameCountDisplay.innerText = initialNames.length;
            
            updateRemainingList();
            resultDisplay.innerHTML = "Ready to pick a winner!";
            drawButton.disabled = false;
            resetButton.disabled = false;
            loadNamesButton.disabled = true;
            nameInput.disabled = true;
        }

        // 2. Pick a Winner
        async function selectRandomWinner() {
            if (employeeNames.length === 0) {
                resultDisplay.innerHTML = "üéâ All names have been picked!";
                drawButton.disabled = true;
                return;
            }

            drawButton.disabled = true;
            resultDisplay.innerHTML = `<span class="draw-animation">Picking...</span>`;
            
            // START picking sound
            if (pickingSound) { 
                pickingSound.currentTime = 0; 
                pickingSound.play().catch(e => console.error("Picking audio play failed:", e)); 
            }

            // Exciting Animation Part 
            const animationDuration = 2000; 
            const intervalTime = 100; 
            let animationEndTime = Date.now() + animationDuration;

            const animationInterval = setInterval(() => {
                
                if (employeeNames.length > 0) { 
                    const tempName = employeeNames[Math.floor(Math.random() * employeeNames.length)];
                    resultDisplay.innerHTML = `<span class="draw-animation">${tempName}</span>`;
                } else {
                     resultDisplay.innerHTML = `<span class="draw-animation">Almost!</span>`;
                }
                
                createSparkle();

                if (Date.now() > animationEndTime) {
                    clearInterval(animationInterval); 
                    revealWinner(); 
                }
            }, intervalTime);
        }

        // Function to reveal the actual winner after animation
        function revealWinner() {
            // STOP picking sound
            if (pickingSound) {
                pickingSound.pause();
                pickingSound.currentTime = 0; 
            }

            const randomIndex = Math.floor(Math.random() * employeeNames.length);

            if (employeeNames.length === 0) {
                return;
            }

            const winner = employeeNames[randomIndex];
            employeeNames.splice(randomIndex, 1); 

            // Display winner with huge text and pop-in animation
            resultDisplay.innerHTML = `Congratulations! The winner is:<br><strong class="winner-name">${winner}</strong>`;
            
            // PLAY winner sound
            if (winSound) {
                winSound.currentTime = 0;
                winSound.play().catch(e => console.error("Win audio play failed:", e));
            }

            fireConfetti();

            updateRemainingList(); 

            if (employeeNames.length === 0) {
                drawButton.disabled = true;
                resultDisplay.innerHTML += " (All names picked!)";
            } else {
                drawButton.disabled = false;
            }
        }


        // 3. Update Remaining Names List on screen
        function updateRemainingList() {
            remainingNamesList.innerHTML = ''; 
            
            // Update Remaining Count
            remainingCountDisplay.innerText = employeeNames.length; 

            if (employeeNames.length === 0) {
                remainingNamesList.innerHTML = '<li>No names remaining</li>';
            } else {
                employeeNames.forEach(name => {
                    const listItem = document.createElement('li');
                    listItem.innerText = name;
                    remainingNamesList.appendChild(listItem);
                });
            }
        }

        // 4. Reset Application
        function resetApp() {
            // Ensure sound is stopped on reset
            if (pickingSound) {
                pickingSound.pause();
                pickingSound.currentTime = 0; 
            }
            
            employeeNames = [...initialNames]; 
            
            if (initialNames.length > 0) {
                totalNameCountDisplay.innerText = initialNames.length;
            } else {
                totalNameCountDisplay.innerText = 0;
            }

            if (employeeNames.length > 0) {
                resultDisplay.innerHTML = "Ready to pick again!";
                drawButton.disabled = false;
                resetButton.disabled = false;
                loadNamesButton.disabled = true;
                nameInput.disabled = true;
            } else {
                resultDisplay.innerHTML = "...Load names to start...";
                drawButton.disabled = true;
                resetButton.disabled = true;
                loadNamesButton.disabled = false;
                nameInput.disabled = false;
                nameInput.value = ""; 
            }
            updateRemainingList();
        }

        // --- Animation Helper: Create Sparkles ---
        function createSparkle() {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            const x = Math.random() * mainContainer.offsetWidth;
            const y = Math.random() * mainContainer.offsetHeight;
            const size = Math.random() * 10 + 5; 
            sparkle.style.width = `${size}px`;
            sparkle.style.height = `${size}px`;
            sparkle.style.left = `${x}px`;
            sparkle.style.top = `${y}px`;
            mainContainer.appendChild(sparkle);

            sparkle.addEventListener('animationend', () => {
                sparkle.remove();
            });
        }

        // --- Confetti & Fireworks Function ---
        function fireConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });

            var duration = 4 * 1000; 
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }


        // --- Event Listeners ---
        loadNamesButton.addEventListener("click", loadNames);
        drawButton.addEventListener("click", selectRandomWinner);
        resetButton.addEventListener("click", resetApp);

        // --- Initial Setup on page load ---
        totalNameCountDisplay.innerText = 0;
        remainingCountDisplay.innerText = 0;
        updateRemainingList(); 
        // END JAVASCRIPT CODE
    </script>
</body>

</html>
